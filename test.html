<!DOCTYPE html><html>
<head>
    <title>成都信息工程大学统一身份认证</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"><!--2 viewport--><meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no"/><!--3、x-ua-compatible--><meta http-equiv="x-ua-compatible" content="IE=edge"><link type="text/css" rel="stylesheet" href="css/common-v1.0.3.css"><link type="text/css" rel="stylesheet" href="css/login-v1.0.3.css"><script type="text/javascript" src="js/jquery.min.js"></script>
        <script type="text/javascript" src="js/security.js"></script>
        <script src="js/jquery.cookie.min.js"></script>
        <script src="js/txtscroll.js"></script>
        <style type="text/css">
                 div.tip_cont{width: 500px;height: 200px;background-color: #fff;margin:200px auto;}
                 div.tip_cont h4{text-align: left;font-size: 20px;font-weight: 500;padding:20px;}
                 div.tip_cont h4 img{margin-right: 10px;margin-top: 3px;}
                 div.tip_cont h4 span.closeSp{margin-top: -5px;font-size: 22px;cursor: pointer;}
                 div.tip_cont div{padding:0px 20px;}
                 div.tip_cont div > span{font-size: 14px;margin-bottom: 15px;line-height: 25px;color: red;padding-left: 28px;}
                 div.tip_cont div p{width: 100%;margin-bottom: 15px;float: left;margin-top: 15px;}
                 div.tip_cont div p a{margin-right: 30px;}
                 #compatibility{display:none;}
        </style>
        <!--[if lte IE 8]>
                <style>
                    div.modal {background: #000; filter:alpha(opacity=40);}
                    div.tip_cont{position:absolute;top:150px;left:50%;margin-left:-250px;}
                </style>
        <![endif]--><script type="text/javascript">
                window.onload = function(){
                        var userAgent = window.navigator.userAgent // 取得浏览器的userAgent字符串
                var isIE = userAgent.indexOf('compatible') > -1 && userAgent.indexOf('MSIE') > -1 // 判断是否IE<11浏览器
                var isEdge = userAgent.indexOf('Edge') > -1 && !isIE // 判断是否IE的Edge浏览器
                var isIE11 = userAgent.indexOf('Trident') > -1 && userAgent.indexOf('rv:11.0') > -1
                if (isIE) {
                        var reIE = new RegExp('MSIE (\\d+\\.\\d+);')
                        reIE.test(userAgent)
                        var fIEVersion = parseFloat(RegExp['$1'])
                        if (fIEVersion <= 9) {
                          var div = document.getElementById('compatibility')
                          div.style.display = 'block'
                          document.getElementById('compatible-close').onclick = function () {
                            div.style.display = 'none'
                          }
                        }
                } else if (isEdge) {
                        return 'edge' // edge
                } else if (isIE11) {
                        return 11 // IE11
                } else {
                        return -1 // 不是ie浏览器
                }
                }
        </script>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"></head>
<body class="maxHeight">
<div class="box">
                <header>
                        <div class="center">
                                <div class="logo_box fl">
                                        <img src="./images/logocuitv2.jpg" alt="" class="fl"></div>
                        </div>
                </header>
                <section>
                        <div class="banner">
                                <div class="center">
                                        <div class="formCT">
                                           <div class="tipInfo fl none">
                                                        <div class="centerImg">
                                                            <h4 class="fl">
                                                                <img src="./images/lgTip.png" alt="" class="fl"><span class="fl">&nbsp;&nbsp;登录提示</span>
                                                                <span class="fr closeSp">×</span>
                                                            </h4>
                                                                <p class="msg"></p>
                                                        </div>
                                                </div>
                                                <div>
    <!-- <div class="box" id="login"> --><!--     <p class="loginTitle" th:utext="#{screen.welcome.instructions}"></p> --><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><div class="form_box fr">
                        <form method="post" id="fm1" autocomplete="off">
                                        <ul class="passLogin fl">
                                                <li class="userInfo">
                                                        <img src="./images/user_icon.png" alt="" class="tipImg"><input type="hidden" name="execution" value="e2s1" /><input type="hidden" name="_eventId" value="submit" /><input type="hidden" name="lm" value="usernameLogin" /><input type="hidden" name="geolocation" /><input type="text" placeholder="请输入网存账户/学号" class="inText required" id="usernamepsw"
                                                        accesskey="n" name="username" value="" ></li>
                                                <li class="userInfo">
                                                        <img src="./images/password_icon.png" alt="" class="tipImg"><input type="password" name="password" placeholder="请输入登录密码"
                                                        class="inText" size="25" id="password"
                                                        accesskey="p" value=""></li>
                                                <li class="phoneLi">
                                                        <img src="./images/verify_icon.png" alt="" class="tipImg"><input type="text" name="captcha" id="captcha" placeholder="请输入图片验证码" value=""><img src="captcha" id="imgCode"></li>
                                    <li class="tipLi">
                                        </li>
                                    <li>
                                                <!--<button type="submit" name="submit" class="btnLg">登 &nbsp;&nbsp;录</button>--><button type="button" onclick="checkLogin();" class="btnLg">登 &nbsp;&nbsp;录</button>
                                        </li>
                                        <li class="last">
<!--                                            <div class="rePas fl"  th:if="${rememberMeAuthenticationEnabled}"> --><!--                                              <p class="l-pwd"> --><!--                                                    <input type="checkbox" name="rememberMe" id="myCheck" value="true" tabindex="5" style="display:none;"> --><!--                    <label for="myCheck" class="fl"></label> --><!--                                                <span class="fl">三天内免登录</span> --><!--                   
                </p> --><!--                                        </div> --><div class="rePas fl">
                                                <p class="l-pwd">
                                                                <!--182--><input type="checkbox" style="width: 19px;height: 19px;float: left;" id="wygm" onclick="wygmCheck();"><label style="margin-left: 4px;">我要改密</label>

                                                                <!----><a style="display:none;" class="forgetPwd fr" href="https://sso.cuit.edu.cn:8088/uap/a/sys/user/accountSafe">我要改密</a>

                                                </p>
                                            </div>
                                                <a class="forgetPwd fr" href="https://sso.cuit.edu.cn:8088/uap/a/sys/user/active">忘记密码</a>
                                        </li>
                                        </ul>
                                        <div class="thirdLg">
                                    <div class="orBox">
                                                <span class="line"></span>
                                                <span class="txt">其他方式登录</span>
                                                <span class="line"></span>
                                            </div>
                         <div class="qqBox">
                                <div class="qq">
                                <p>
                                        <a onclick="window.open('otherLogin?number=one&type=qq&requestUrl=' + weChatLogin())">
                                            <img src="./images/qq.png" alt=""><span>&nbsp;QQ登录</span>
                                    </a>
                                </p>
                            </div>
                                <div class="wx">
                                        <p>
                                                <a onclick="window.open('otherLogin?number=one&type=wechat&requestUrl=' + weChatLogin())">
                                           <img src="./images/weixin.png" alt=""><span>&nbsp;微信登录</span>
                                   </a>
                                </p>
                                </div>
                        </div>
                                        </div>
                        </form>
                </div>
<script type="text/javascript">
    var i = "\u6B63\u5728\u767B\u5F55..."
    $("#fm1").submit(function() {
        $(":submit").attr("disabled", true);
        $(":submit").attr("value", i);
        return true;
    });

    function weChatLogin() {
                var msg = window.location.href;
                return msg;
        }

        //获取url中的参数
        function getUrlParam(name) {
                var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)"); //构造一个含有目标参数的正则表达式对象
                var r = window.location.search.substr(1).match(reg);  //匹配目标参数
                if (r != null) return unescape(r[2]); return null; //返回参数值
        }
        //获取service参数
        var service = getUrlParam("service");
        var refer = getUrlParam("refer");
        function wygmCheck(){
                var wygm = $("#wygm").prop("checked");
                var jump = "https://sso.cuit.edu.cn/authserver/login";
                if(wygm){
                        jump = "https://sso.cuit.edu.cn/authserver/login?service="+encodeURI("https://sso.cuit.edu.cn:8088/uap/a/cas");
                        //$("#fm1").attr("action","login?service="+encodeURI("https://sso.cuit.edu.cn:8088/uap/a/cas"));
                        if(null != service)
                                jump = jump+"&refer="+encodeURI(service);
                }else{
                        //$("#fm1").attr("action",null==service?"login":"login?service="+encodeURI(service));
                        if(null != refer)
                                jump = jump+"?service="+encodeURI(refer);
                }

                var timestamp = (new Date()).valueOf();
                var url = "captcha";
            if ((url.indexOf("&") >= 0)) {
                url = url + "×tamp=" + timestamp;
            } else {
                url = url + "?timestamp=" + timestamp;
            }
                $("#imgCode").attr("src", url);

                $.ajax({
                url: jump,
                type:"get",
                async:false,
                dataType:"html",
                success:function(html){
                        var newE = $(html).find("input[name=execution]").val();
                        $("input[name=execution]").val(newE);
                }});
                //window.location.href=jump;
        }

        function checkLogin(){
                var name = $("#usernamepsw").val().trim();
                var pwd = $("#password").val().trim();
                var captcha = $("#captcha").val().trim();
                if(name =='' || name.length < 1){
                        $(".tipLi").html("<p class='textError'><span>请输入网存账户/学号</span></p>");
                        return;
                }
                if(pwd =='' || pwd.length < 1){
                        $(".tipLi").html("<p class='textError'><span>请输入登录密码</span></p>");
                        return;
                }
                if(captcha =='' || captcha.length < 1){
                        $(".tipLi").html("<p class='textError'><span>请输入图片验证码</span></p>");
                        return;
                }

                $.ajax({
                url: "loginCheck",
                type:"get",
                        data:{"name":name,"pwd":pwd,"captcha":captcha},
                async:false,
                dataType:"text",
                success:function(data){

                                var timestamp = (new Date()).valueOf();
                                var captcha_url = "captcha";
                                if ((captcha_url.indexOf("&") >= 0)) {
                                        captcha_url = captcha_url + "×tamp=" + timestamp;
                                } else {
                                        captcha_url = captcha_url + "?timestamp=" + timestamp;
                                }

                        if(data == "success"){
                                $(".tipLi").html("");
                                        $("#fm1").submit();
                        }else if(data == "参数错误"){
                                $(".tipLi").html("<p class='textError'><span>参数错误</span></p>");
                        }else if(data == "验证码错误"){
                                $(".tipLi").html("<p class='textError'><span>验证码错误</span></p>");
                        }else if(data == "验证码多次错误"){
                                $("#imgCode").attr("src", captcha_url);
                        }else{
                                $("#imgCode").attr("src", captcha_url);
                                $(".tipLi").html("<p class='textError'><span>"+data+"</span></p>");
                                }
                        }
                });
        }

        $(function(){

                if(null != refer)
                        $("#wygm").prop("checked",true);

                $("#imgCode").on("click", function() {
                        var timestamp = (new Date()).valueOf();
                    url = "captcha";
                    if ((url.indexOf("&") >= 0)) {
                        url = url + "×tamp=" + timestamp;
                    } else {
                        url = url + "?timestamp=" + timestamp;
                    }
                        $(this).attr("src", url);
                });

                var msg = window.location.href;
                $('iframe').attr('src',"otherLogin?number=one&type=wechat&requestUrl="+msg);


                $('ul.passLogin li.userInfo').find('input').focus(function(){
                $('div.tipInfo').slideDown("slow");
        });
        $('ul.passLogin li.phoneLi').find('input').focus(function(){
                $('div.tipInfo').slideUp("slow");
        });

        // 点击关闭按钮
        $('div.tipInfo').find('span.closeSp').click(function(){
                $('div.tipInfo').slideUp("slow");
        })

        })

</script>
    </div>
                                        </div>
                                </div>
                        </div>
                </section>
                <div class="notifyBox">
                        <div class="center">
                                <div class="tipBox">
                                        <div class="txt-scroll txt-scroll-default">
                                            <div class="scrollbox">
                                                <div class="txt"></div>
                                            </div>
                                        </div>
                                </div>
                        </div>
                </div>
                <div class="footer_box">
                        <div class="center">
                                <footer>
                                        <img src="./images/blueLG.png" alt="" class="fl"><div class="description fl">
                                                <p>
                                                        航空港校区 | 四川省成都市西南航空港经济开发区学府路一段24号 | 邮编：610225 | 电话：028-85966502 <br/>
                                                         龙泉校区 | 成都市龙泉驿区阳光城幸福路10号 | 邮编：610103 | 电话：028-84833333
                                                </p>
                                        </div>
                                </footer>
                        </div>
                </div>
                <div class="modal" id="compatibility">
                        <div class="tip_cont">
                                <h4>
                                        <img src="./images/lgTip.png" alt="" class="fl"><span>温馨提示</span>
                                        <span class="fr closeSp" id="compatible-close">×</span>
                                </h4>
                                <div>
                                        <span>系统检测到您当前使用的浏览器为ie内核且版本过低，为保证正常登录，推荐使用Chrome、Firefox、360 极速浏览器或选用IE10及以上版本进行访问 。</span>
                                    <p>
                                        <a href="http://www.chromeliulanqi.com">下载谷歌</a>
                                        <a href="http://www.firefox.com.cn">下载火狐</a>
                                    </p>
                                </div>
                        </div>
                </div>
        </div>
<script>
        var i = "正在登录...";
        var Modulus, public_exponent;

        $(function(){
                initData();
    });

        function initData() {
                $.ajax({
                url: "data/list",
                type:"post",
                async:true,
                success:function(data){
                        if (data.msg) {
                                $('.msg').html(data.msg);
                        }
                        if (data.barpath) {
                                var banners = data.barpath.split(",");
                                var len = banners.length - 1;
                                var rand = parseInt(Math.floor(Math.random()*len));
                                $.each(banners, function(index, val) {
                                        if (index == rand) {
                                                $(".banner").css("background","url('"+val+"') center no-repeat");
                                        }
                                })
                        }

                        if (data.list) {
                                var content='';
                                var count = 0;
                                for(var i=0;i<data.list.length;i++){
                                        var item=data.list[i];
                                        var title = item.title;
                                        var articleUrl = item.articleUrl;
                                        content+='<a href="'+item.articleUrl+'" target="_blank" title="'+item.title+'">'+item.title+'&nbsp&nbsp&nbsp&nbsp&nbsp</a>';
                                }
                                $('div.tipBox div.txt').html(content);
                                $('div.txt-scroll').txtscroll({ 'speed': 20 });
                        }
                }
        })
        }

        $("#fm1").submit(function() {
            $(":submit").attr("disabled", true);
            $(":submit").attr("value", i);
            return true;
        });
        if(window.top!==window.self){window.top.location=window.location};

        //防止页面后退
    history.pushState(null, null, document.URL);
    window.addEventListener('popstate', function () {
        history.pushState(null, null, document.URL);
    });

    function IsPC() {
        var userAgentInfo = navigator.userAgent;
        var Agents = ["Android", "iPhone","SymbianOS", "Windows Phone","iPad", "iPod","webOS"];

        var flag = true;
        for (var v = 0; v < Agents.length; v++) {
            if (userAgentInfo.indexOf(Agents[v]) > 0) {
                flag = false;
                break;
            }
        }
        return flag;
    }
    var flag = IsPC();

    window.onresize=resizeBannerImage;
        function resizeBannerImage(){
                var winW = $(window).width();
                if( winW < 1000 ) {
                    $('ul.passLogin li.userInfo').find('input').focus(function(){
                            $('div.tipInfo').addClass('none');
                            console.log('ss')

                });
                $('ul.passLogin li.userInfo').find('input').blur(function(){
                        $('div.tipInfo').addClass('none');

                });
                }
        }

 </script>
</body>
</html>